(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/article-imple/article-imple"],{"04d4":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=c(n("a34a")),a=c(n("6c41")),i=c(n("2d2c")),o=n("2f62");function c(t){return t&&t.__esModule?t:{default:t}}function s(t,e,n,r,a,i,o){try{var c=t[i](o),s=c.value}catch(u){return void n(u)}c.done?e(s):Promise.resolve(s).then(r,a)}function u(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var i=t.apply(e,n);function o(t){s(i,r,a,o,c,"next",t)}function c(t){s(i,r,a,o,c,"throw",t)}o(void 0)}))}}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d=function(){n.e("components/article-editor-item/article-editor-item").then(function(){return resolve(n("7a62"))}.bind(null,n)).catch(n.oe)},p=function(){Promise.all([n.e("common/vendor"),n.e("components/gaoyia-parse/parse")]).then(function(){return resolve(n("fe92"))}.bind(null,n)).catch(n.oe)},m=function(){Promise.all([n.e("common/vendor"),n.e("components/mpvue-wxparse/src/wxParse")]).then(function(){return resolve(n("ec90"))}.bind(null,n)).catch(n.oe)},b=function(){n.e("components/classify-selector/classify-selector").then(function(){return resolve(n("e881"))}.bind(null,n)).catch(n.oe)},v={computed:f({},(0,o.mapState)(["systemUserInfo","userid","labelAll","answerTopicCache"])),onLoad:function(e){this.getLabelName(),this.countMaxLength();var n=e.params;"main"===n?(this.isAnswerTopic=!1,t.setNavigationBarTitle({title:"写文章"})):"answer"===n&&(this.isAnswerTopic=!0,this.topic_title=this.answerTopicCache.title,this.typeName=this.answerTopicCache.type,this.topic_id=this.answerTopicCache.id,t.setNavigationBarTitle({title:"回复话题"}))},components:{EditorItem:d,UParse:p,wxParse:m,ClassifySelector:b},data:function(){return{textareaData:"",textareaHtml:"",showConvert:!1,isAnswerTopic:!1,topic_id:"",topic_title:"",maxlength:500,title:"",typeArray:[],typeName:""}},watch:{textareaData:function(t){this.textareaHtml=(0,a.default)(t)}},methods:{getLabelName:function(){for(var t=0;t<this.labelAll.length;t++)this.typeArray.push(this.labelAll[t].label_name)},convert:function(){this.showConvert=!this.showConvert},submit:function(){""!==this.textareaData&&0!==this.textareaData.length?""!==this.title&&0!==this.title.length?(this.showConvert=!0,this.isAnswerTopic?this.publishTopicAnswer():this.$refs.popup.open()):t.showToast({title:"请输入标题",icon:"none"}):t.showToast({title:"请输入提交的内容",icon:"none"})},publishTopicAnswer:function(){var e=this;return u(r.default.mark((function n(){var a;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.showLoading(),"",a=wx.getFileSystemManager(),a.writeFileSync("".concat(wx.env.USER_DATA_PATH,"/forum.text"),e.textareaData,"utf-8"),n.next=6,(0,i.default)("".concat(wx.env.USER_DATA_PATH,"/forum.text"),"forum-article/",(function(t){t}),(function(e){t.hideLoading()}));case 6:case"end":return n.stop()}}),n)})))()},publishArticle:function(e){var n=this;return u(r.default.mark((function a(){var o,c;return r.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(0!==e){r.next=3;break}return t.showToast({title:"请选择类型",icon:"none"}),r.abrupt("return");case 3:return t.showLoading(),o="",c=wx.getFileSystemManager(),c.writeFileSync("".concat(wx.env.USER_DATA_PATH,"/forum.text"),n.textareaData,"utf-8"),r.next=9,(0,i.default)("".concat(wx.env.USER_DATA_PATH,"/forum.text"),"forum-article/",(function(t){o=t}),(function(e){t.hideLoading()}));case 9:n.writeArticle(n.title,e,o,covers);case 10:case"end":return r.stop()}}),a)})))()},countMaxLength:function(){var t=this.systemUserInfo["integral_count"];this.maxlength=t<=100?1500:100<t<=300?2500:300<t<=500?4e3:5e3},closeCommentView:function(){this.$refs.popup.close()},answerTopic:function(e,n,r){t.request({url:""})},writeArticle:function(e,n,r,a){t.request({url:"http://localhost:8000/forum/create_article",method:"POST",data:{id:this.userid,title:e,classify:n,content:r,covers:a}})},toolBarClick:function(t){switch(t){case"bold":this.textareaData+="**粗体文字**";break;case"italic":this.textareaData+="*斜体* ";break;case"underline":break;case"imgage":break;case"code":this.textareaData+="\n``` 代码块 \n\n```\n";break;case"table":this.textareaData+="\n|列1|列2|列3|\n|-|-|-|\n|单元格1|单元格2|单元格3|\n";break;case"clear":break}}}};e.default=v}).call(this,n("543d")["default"])},1045:function(t,e,n){},2714:function(t,e,n){"use strict";var r=n("1045"),a=n.n(r);a.a},7396:function(t,e,n){"use strict";n.r(e);var r=n("d276"),a=n("b0a5");for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);n("2714");var o,c=n("f0c5"),s=Object(c["a"])(a["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],o);e["default"]=s.exports},a517:function(t,e,n){"use strict";(function(t){n("31d6");r(n("66fd"));var e=r(n("7396"));function r(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},b0a5:function(t,e,n){"use strict";n.r(e);var r=n("04d4"),a=n.n(r);for(var i in r)"default"!==i&&function(t){n.d(e,t,(function(){return r[t]}))}(i);e["default"]=a.a},d276:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return r}));var r={articleEditorItem:function(){return n.e("components/article-editor-item/article-editor-item").then(n.bind(null,"7a62"))},classifySelector:function(){return n.e("components/classify-selector/classify-selector").then(n.bind(null,"e881"))}},a=function(){var t=this,e=t.$createElement;t._self._c},i=[]}},[["a517","common/runtime","common/vendor"]]]);