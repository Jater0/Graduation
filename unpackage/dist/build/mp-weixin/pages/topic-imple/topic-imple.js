(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/topic-imple/topic-imple"],{"0984":function(e,t,n){"use strict";var i=n("ce19"),o=n.n(i);o.a},"1f4f":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n("a34a")),o=n("2f62"),r=a(n("2d2c"));function a(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n,i,o,r,a){try{var c=e[r](a),u=c.value}catch(s){return void n(s)}c.done?t(u):Promise.resolve(u).then(i,o)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function a(e){c(r,i,o,a,u,"next",e)}function u(e){c(r,i,o,a,u,"throw",e)}a(void 0)}))}}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=function(){n.e("components/classify-selector/classify-selector").then(function(){return resolve(n("e881"))}.bind(null,n)).catch(n.oe)},d={components:{ClassifySelector:p},data:function(){return{topicValue:"",typeArray:[],imageList:[],updateImageList:[],typeName:""}},watch:{updateImageList:function(e){e.length===this.imageList.length&&this.updateTopic(this.topicValue,this.typeName,e)}},computed:l({},(0,o.mapState)(["userid","labelAll"])),onLoad:function(){this.getLabelName()},methods:{getLabelName:function(){for(var e=0;e<this.labelAll.length;e++)this.typeArray.push(this.labelAll[e].label_name)},chooseImage:function(){var t=3-this.imageList.length,n=this;e.chooseImage({count:t,success:function(e){var i=e.tempFilePaths;i.forEach((function(e,i){i<t&&n.imageList.push({url:e})}))}})},removeImage:function(e){this.imageList.splice(e,1)},submit:function(){""!==this.topicValue&&0!==this.topicValue.length?this.$refs.popup.open():e.showToast({title:"请输入提交的内容",icon:"none"})},closeCommentView:function(){this.$refs.popup.close(),this.typeName=""},publish:function(t){var n=this;return u(i.default.mark((function o(){var r,a;return i.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(0!==t){i.next=3;break}return e.showToast({title:"请选择类型",icon:"none"}),i.abrupt("return");case 3:if(e.showLoading(),n.typeName=t,0==n.imageList.length){i.next=16;break}r=0;case 7:if(!(r<n.imageList.length)){i.next=14;break}return a=n.imageList[r].url,i.next=11,n.updateFiles(a);case 11:r++,i.next=7;break;case 14:i.next=17;break;case 16:n.updateTopic(n.topicValue,t,[]);case 17:case"end":return i.stop()}}),o)})))()},updateFiles:function(e){var t=this;return u(i.default.mark((function n(){return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,r.default)(e,"forum-cover/",(function(e){t.updateImageList.push(e)}));case 2:case"end":return n.stop()}}),n)})))()},updateTopic:function(t,n,i){var o=this;e.request({url:"http://localhost:8000/forum/update_topic",data:{uid:this.userid,title:t,classify:n,covers:i},success:function(t){var n=t.data,i=(n.data,n.code);200===i?(e.hideLoading(),o.closeCommentView(),e.showToast({title:"创建话题成功"}),setTimeout((function(){e.switchTab({url:"/pages/tabbar/index/index"})}),2e3)):(e.hideLoading(),o.closeCommentView(),e.showToast({title:"创建话题成功失败, 请稍后再试",icon:"none"}))},fail:function(t){e.hideLoading(),o.closeCommentView(),e.showToast({title:"创建话题成功失败, 请稍后再试",icon:"none"})}})}}};t.default=d}).call(this,n("543d")["default"])},"282c":function(e,t,n){"use strict";n.r(t);var i=n("d9be"),o=n("b211");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);n("0984");var a,c=n("f0c5"),u=Object(c["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],a);t["default"]=u.exports},"8f85":function(e,t,n){"use strict";(function(e){n("31d6");i(n("66fd"));var t=i(n("282c"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},b211:function(e,t,n){"use strict";n.r(t);var i=n("1f4f"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},ce19:function(e,t,n){},d9be:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var i={uniIcons:function(){return Promise.all([n.e("common/vendor"),n.e("components/uni-icons/uni-icons")]).then(n.bind(null,"25da"))},classifySelector:function(){return n.e("components/classify-selector/classify-selector").then(n.bind(null,"e881"))}},o=function(){var e=this,t=e.$createElement;e._self._c},r=[]}},[["8f85","common/runtime","common/vendor"]]]);